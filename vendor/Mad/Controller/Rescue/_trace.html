<p><code>MAD_ROOT: <?php if (defined('MAD_ROOT')): ?><?php echo MAD_ROOT ?><?php else: ?>unset<?php endif ?></code></p>

<div id="traces">
  <div id="Application-Trace" style="display: block;">
    <pre><code><?php 
                  foreach($this->trace as $i => $frame) {
                    $glue = ($i==0) ? ' in ' : ': ';
                    echo "{$frame->fileStripped}({$frame->line})$glue{$frame->method}\n";
                  }  
               ?></pre>
  </div>
</div>

<?php if ($this->extraction): ?>

Extracted source (around 
<a href="<?php echo $this->trace[0]->url ?>">line #<?php echo $this->extraction->line ?></a>)

<pre>
<?php
 end($this->extraction->source);
 $width = strlen(key($this->extraction->source));

 foreach ($this->extraction->source as $line => $code) {
   echo str_repeat(' ', $width-strlen($line)) . $line;
   echo ': ' . htmlentities($code) ."\n";
 }

?>
</pre>
<?php endif ?>
